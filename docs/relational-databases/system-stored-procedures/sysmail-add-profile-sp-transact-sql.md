---
description: "The sysmail_add_profile_sp system stored procedure created a new Database Mail profile in an instance of SQL Server or Azure SQL Managed Instance."
title: "sysmail_add_profile_sp (Transact-SQL)"
ms.custom: ""
ms.date: "04/19/2022"
ms.service: sql
ms.reviewer: ""
ms.subservice: system-objects
ms.topic: "reference"
f1_keywords: 
  - "sysmail_add_profile_sp_TSQL"
  - "sysmail_add_profile_sp"
dev_langs: 
  - "TSQL"
helpviewer_keywords: 
  - "sysmail_add_profile_sp"
author: markingmyname
ms.author: maghan
---
# sysmail_add_profile_sp (Transact-SQL)
[!INCLUDE [SQL Server - ASDBMI](../../includes/applies-to-version/sql-asdbmi.md)]

  Creates a new [Database Mail](../../relational-databases/database-mail/database-mail.md) profile.  
  
 ![Topic link icon](../../database-engine/configure-windows/media/topic-link.gif "Topic link icon") [Transact-SQL Syntax Conventions](../../t-sql/language-elements/transact-sql-syntax-conventions-transact-sql.md)  
  
## Syntax  
  
```syntaxsql 
sysmail_add_profile_sp [ @profile_name = ] 'profile_name'  
    [ , [ @description = ] 'description' ]  
    [ , [ @profile_id = ] new_profile_id OUTPUT ]  
```  

## Arguments  

#### `[ @profile_name = ] 'profile\_name'`
 The name for the new profile. *profile_name* is **sysname**, with no default.  
 
  > [!NOTE]  
  > To send e-mail using SQL Agent jobs in [!INCLUDE[ssazuremi_md](../../includes/ssazuremi_md.md)], SQL Server Agent can use only one Database Mail profile, and it must be called `AzureManagedInstance_dbmail_profile`. For more information and a sample script, see [Azure SQL Managed Instance SQL Agent job notifications](/azure/azure-sql/managed-instance/job-automation-managed-instance#sql-agent-job-notifications).
  
#### `[ @description = ] 'description'`
 The optional description for the new profile. *description* is **nvarchar(256)**, with no default.  
  
#### `[ @profile_id = ] _new\_profile\_id OUTPUT`
 Returns the ID for the new profile. *new_profile_id* is **int**, with a default of NULL.  
  
## Return Code Values  
 **0** (success) or **1** (failure)  
  
## Remarks  
 A Database Mail profile holds any number of Database Mail accounts. Database Mail stored procedures can refer to a profile by either the profile name or the profile ID generated by this procedure. For more information about adding an account to a profile, see [sysmail_add_profileaccount_sp &#40;Transact-SQL&#41;](../../relational-databases/system-stored-procedures/sysmail-add-profileaccount-sp-transact-sql.md).  
  
 The profile name and description can be changed with the stored procedure `sysmail_update_profile_sp`, while the profile ID remains constant for the life of the profile.  
  
 The profile name must be unique in the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] instance or the stored procedure returns an error.  
  
 The stored procedure `sysmail_add_profile_sp` is in the `msdb` database and is owned by the `dbo` schema. The procedure must be executed with a three-part name if the current database is not `msdb`.  
  
## Permissions  
 Execute permissions for this procedure default to members of the **sysadmin** fixed server role.  
  
## Examples  

### A. Creating a new profile
  
 The following example creates a new Database Mail profile named `AdventureWorks Administrator`.  
  
```sql  
EXECUTE msdb.dbo.sysmail_add_profile_sp  
       @profile_name = 'AdventureWorks Administrator',  
       @description = 'Profile used for administrative mail.' ;  
```  
  
### B. Creating a new profile, saving the profile ID in a variable
  
 The following example creates a new Database Mail profile named `AdventureWorks Administrator`. The example stores the profile ID number in the variable `@profileId` and returns a result set containing the profile ID number for the new profile.  
  
```sql  
DECLARE @profileId INT ;  
  
EXECUTE msdb.dbo.sysmail_add_profile_sp  
       @profile_name = 'AdventureWorks Administrator',  
       @description = 'Profile used for administrative mail.',  
       @profile_id = @profileId OUTPUT ;  
  
SELECT @profileId ;  
```  
  
## See also

- [Database Mail](../../relational-databases/database-mail/database-mail.md)   
- [Database Mail Configuration Objects](../../relational-databases/database-mail/database-mail-configuration-objects.md)   
- [Database Mail Stored Procedures &#40;Transact-SQL&#41;](../../relational-databases/system-stored-procedures/database-mail-stored-procedures-transact-sql.md)  

## Next steps

- [Configure Database Mail](../../relational-databases/database-mail/configure-database-mail.md)
- [Create a Database Mail Account](../../relational-databases/database-mail/create-a-database-mail-account.md)   
- [Configure SQL Server Agent Mail to Use Database Mail](../../relational-databases/database-mail/configure-sql-server-agent-mail-to-use-database-mail.md)
- [Automate management tasks using SQL Agent jobs in Azure SQL Managed Instance](/azure/azure-sql/managed-instance/job-automation-managed-instance)